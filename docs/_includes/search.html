<!-- Search Component -->
<div class="search-container" id="search-container">
  <div class="search-overlay"></div>
  
  <div class="search-modal">
    <div class="search-header">
      <h3>{% if page.lang == 'it' %}Cerca{% else %}Search{% endif %}</h3>
      <button type="button" class="search-close" id="search-close" aria-label="Close search">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <form class="search-form" role="search">
      <div class="search-input-wrapper">
        <i class="fas fa-search"></i>
        <input type="search" id="search-input" class="search-input" 
               placeholder="{% if page.lang == 'it' %}Cerca nel manuale...{% else %}Search the handbook...{% endif %}">
        <button type="button" class="search-clear" id="search-clear" aria-label="Clear search">
          <i class="fas fa-times-circle"></i>
        </button>
      </div>
    </form>
    
    <div class="search-results" id="search-results">
      <div class="search-message">
        {% if page.lang == 'it' %}
          <p>Inizia a digitare per cercare nel manuale.</p>
        {% else %}
          <p>Start typing to search the handbook.</p>
        {% endif %}
      </div>
      
      <div class="search-results-list" id="results-list"></div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const searchContainer = document.getElementById('search-container');
    const searchClose = document.getElementById('search-close');
    const searchInput = document.getElementById('search-input');
    const searchClear = document.getElementById('search-clear');
    const searchResults = document.getElementById('search-results');
    const resultsList = document.getElementById('results-list');
    const searchMessage = document.querySelector('.search-message');
    
    // Close search when clicking close button
    searchClose.addEventListener('click', function() {
      searchContainer.classList.remove('active');
      searchInput.value = '';
      showSearchMessage();
    });
    
    // Clear search input
    searchClear.addEventListener('click', function() {
      searchInput.value = '';
      searchInput.focus();
      showSearchMessage();
    });
    
    // Handle search input
    searchInput.addEventListener('input', function() {
      if (this.value.length > 0) {
        searchClear.style.display = 'block';
        performSearch(this.value);
      } else {
        searchClear.style.display = 'none';
        showSearchMessage();
      }
    });
    
    // Show search message
    function showSearchMessage() {
      searchMessage.style.display = 'block';
      resultsList.style.display = 'none';
      resultsList.innerHTML = '';
    }
    
    // Simple search function (to be enhanced with proper search implementation)
    function performSearch(query) {
      if (query.length < 2) return;
      
      searchMessage.style.display = 'none';
      resultsList.style.display = 'block';
      
      // Example results (to be replaced with actual search)
      const results = [
        {
          title: 'About This Book',
          url: '/chapters/en/about-this-book.html',
          content: 'The Peeragogy Handbook is a resource for self-organizing peer learning...'
        },
        {
          title: 'Peeragogy in a Nutshell',
          url: '/chapters/en/peeragogy-in-a-nutshell.html',
          content: 'This addresses the challenge: how can people learn together without a teacher?'
        }
      ];
      
      resultsList.innerHTML = '';
      
      results.forEach(function(result) {
        const resultItem = document.createElement('div');
        resultItem.className = 'search-result-item';
        
        resultItem.innerHTML = `
          <a href="${result.url}">
            <h4>${result.title}</h4>
            <p>${result.content}</p>
          </a>
        `;
        
        resultsList.appendChild(resultItem);
      });
    }
    
    // Initial setup
    searchClear.style.display = 'none';
    showSearchMessage();
  });
</script>